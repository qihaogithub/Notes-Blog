ä¸€ä¸ªä¸ªäººåšå®¢ç½‘ç«™ï¼Œã€Œç¬”è®°ä»“åº“ã€å’Œã€Œåšå®¢ä»“åº“ã€å®Œå…¨åˆ†ç¦»ï¼Œåšå®¢ä»“åº“è‡ªåŠ¨è¯»å–ç¬”è®°ä»“åº“çš„ Markdown æ–‡ä»¶ã€‚æ— éœ€åç«¯ã€é›¶ç»´æŠ¤ã€å®‰å…¨å¯é 

---

### ğŸŒŸ æ ¸å¿ƒæ¶æ„

```
ç¬”è®°ä»“åº“ (notes-repo)         åšå®¢ä»“åº“ (blog-repo)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  notes/         â”‚          â”‚ .github/        â”‚
â”‚  â”œâ”€â”€ post1.md   â”‚          â”‚ â””â”€â”€ workflows/  â”‚
â”‚  â”œâ”€â”€ images/    â”‚          â”‚   â””â”€â”€ deploy.ymlâ”‚
â”‚  â””â”€â”€ ...        â”‚          â”‚ public/         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- âœ… **ç¬”è®°ä»“åº“**ï¼šåªå­˜æ”¾ Markdown å†…å®¹ï¼ˆå®Œå…¨ç‹¬ç«‹ï¼‰
- âœ… **åšå®¢ä»“åº“**ï¼šåªè´Ÿè´£é™æ€é¡µé¢ç”Ÿæˆå’Œéƒ¨ç½²ï¼ˆæ— ä»»ä½•å†…å®¹ï¼‰
- âœ… **è‡ªåŠ¨åŒæ­¥**ï¼šåšå®¢ä»“åº“é€šè¿‡ GitHub Actions å®šæ—¶æ‹‰å–ç¬”è®°ä»“åº“å†…å®¹

---

### âœ… è¯¦ç»†å®ç°æ­¥éª¤

#### ğŸ” ç¬¬ä¸€æ­¥ï¼šåˆ›å»º GitHub PATï¼ˆä¸ªäººè®¿é—®ä»¤ç‰Œï¼‰

> ç”¨äºåšå®¢ä»“åº“å®‰å…¨è®¿é—®ç¬”è®°ä»“åº“ï¼ˆä»…éœ€**åªè¯»æƒé™**ï¼‰

1. è®¿é—® [GitHub PAT åˆ›å»ºé¡µé¢](https://github.com/settings/tokens/new)
2. å‹¾é€‰æƒé™ï¼š
   - âœ… `repo`ï¼ˆä»…å‹¾é€‰ `repo:status` å’Œ `repo:public_repo`ï¼‰
   - âš ï¸ **ä¸è¦å‹¾é€‰ `write:repo` æˆ– `admin:repo_hook`**
3. å¤åˆ¶ç”Ÿæˆçš„ Tokenï¼ˆç±»ä¼¼ `ghp_abc123...`ï¼‰

#### ğŸ“Œ ç¬¬äºŒæ­¥ï¼šå°† PAT å­˜å…¥åšå®¢ä»“åº“çš„ Secrets

1. è¿›å…¥ä½ çš„ **åšå®¢ä»“åº“** â†’ Settings â†’ Secrets and variables â†’ Actions
2. ç‚¹å‡» **New repository secret**
3. è®¾ç½®ï¼š
   - **Name**: `NOTE_REPO_TOKEN`
   - **Value**: åˆšå¤åˆ¶çš„ PATï¼ˆå¦‚ `ghp_abc123...`ï¼‰
4. ç‚¹å‡» **Add secret**

#### ğŸ“‚ ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºåšå®¢ä»“åº“ç»“æ„

åœ¨åšå®¢ä»“åº“ä¸­åˆ›å»ºä»¥ä¸‹æ–‡ä»¶ï¼š

```
blog-repo/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ deploy.yml      # è‡ªåŠ¨éƒ¨ç½²é…ç½®
â”œâ”€â”€ package.json            # ä¾èµ–é…ç½®
â”œâ”€â”€ build.js                # å†…å®¹è½¬æ¢è„šæœ¬
â””â”€â”€ public/                 # ç”Ÿæˆçš„é™æ€æ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
```

#### âš™ï¸ ç¬¬å››æ­¥ï¼šé…ç½®å…³é”®æ–‡ä»¶

**æ–‡ä»¶ï¼š`package.json`**

```json
{
  "name": "blog",
  "version": "1.0.0",
  "scripts": {
    "build": "node build.js"
  },
  "dependencies": {
    "marked": "^4.0.10"
  }
}
```

**æ–‡ä»¶ï¼š`build.js`**ï¼ˆæ ¸å¿ƒè„šæœ¬ï¼‰

```javascript
const fs = require("fs");
const path = require("path");
const marked = require("marked");

// === å…³é”®é…ç½® ===
const NOTE_REPO_PATH = "temp-notes"; // ç¬”è®°ä»“åº“å†…å®¹å­˜æ”¾è·¯å¾„
const PUBLIC_DIR = "public"; // ç”Ÿæˆçš„é™æ€æ–‡ä»¶ç›®å½•

// æ¸…ç©ºå¹¶é‡å»ºpublicç›®å½•
if (fs.existsSync(PUBLIC_DIR)) {
  fs.rmSync(PUBLIC_DIR, { recursive: true, force: true });
}
fs.mkdirSync(PUBLIC_DIR, { recursive: true });

// å¤åˆ¶ç¬”è®°ä»“åº“çš„æ•´ä¸ªç›®å½•åˆ°publicï¼ˆä¿ç•™å›¾ç‰‡ç­‰èµ„æºï¼‰
fs.cpSync(NOTE_REPO_PATH, PUBLIC_DIR, { recursive: true });

// ç”Ÿæˆåšå®¢é¦–é¡µ
const posts = [];
const mdFiles = fs.readdirSync(NOTE_REPO_PATH).filter((f) => f.endsWith(".md"));

mdFiles.forEach((file) => {
  const filePath = path.join(NOTE_REPO_PATH, file);
  const content = fs.readFileSync(filePath, "utf8");

  // æå–æ ‡é¢˜ï¼ˆä¼˜å…ˆä½¿ç”¨# æ ‡é¢˜ï¼Œå¦åˆ™ç”¨æ–‡ä»¶åï¼‰
  let title = file.replace(".md", "");
  const firstLine = content.split("\n")[0];
  if (firstLine.startsWith("# ")) {
    title = firstLine.substring(2).trim();
  }

  // è½¬æ¢Markdownä¸ºHTML
  const html = marked(content);

  // ä¿å­˜å•ä¸ªæ–‡ç« é¡µ
  const htmlFile = path.join(PUBLIC_DIR, file.replace(".md", ".html"));
  fs.writeFileSync(htmlFile, `<html><body>${html}</body></html>`);

  // è®°å½•åˆ°é¦–é¡µ
  posts.push({ title, filename: file.replace(".md", ".html") });
});

// ç”Ÿæˆé¦–é¡µ index.html
let indexHtml = `
<!DOCTYPE html>
<html>
<head>
  <title>æˆ‘çš„åšå®¢</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
    h1 { color: #333; }
    ul { list-style-type: none; padding: 0; }
    li { margin: 15px 0; }
    a { text-decoration: none; color: #0066cc; }
    a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <h1>æˆ‘çš„åšå®¢</h1>
  <ul>
    ${posts
      .map((post) => `<li><a href="${post.filename}">${post.title}</a></li>`)
      .join("")}
  </ul>
</body>
</html>
`;

fs.writeFileSync(path.join(PUBLIC_DIR, "index.html"), indexHtml);
console.log("âœ… åšå®¢ç”Ÿæˆå®Œæˆï¼å…±", posts.length, "ç¯‡æ–‡ç« ");
```

**æ–‡ä»¶ï¼š`.github/workflows/deploy.yml`**ï¼ˆå…³é”®é…ç½®ï¼‰

```yaml
name: Sync Notes & Deploy

on:
  # æ¯å°æ—¶è‡ªåŠ¨åŒæ­¥ï¼ˆå¯è°ƒæ•´é¢‘ç‡ï¼‰
  schedule:
    - cron: "0 * * * *" # æ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡

  # æ‰‹åŠ¨è§¦å‘ï¼ˆå¯é€‰ï¼‰
  workflow_dispatch:

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      # 1. æ£€å‡ºåšå®¢ä¸»ä»“åº“ï¼ˆç©ºä»“åº“ï¼‰
      - name: Checkout main repo
        uses: actions/checkout@v3

      # 2. æ£€å‡ºç¬”è®°ä»“åº“ï¼ˆå…³é”®ï¼ï¼‰
      - name: Checkout notes repository
        uses: actions/checkout@v3
        with:
          repository: YOUR_NOTE_REPO_OWNER/NOTE_REPO_NAME # æ›¿æ¢ä¸ºä½ çš„ç¬”è®°ä»“åº“
          ref: main # ç¬”è®°ä»“åº“åˆ†æ”¯
          path: temp-notes # æœ¬åœ°å­˜æ”¾è·¯å¾„
          token: ${{ secrets.NOTE_REPO_TOKEN }} # ä»Secretsè¯»å–

      # 3. å¦‚æœç¬”è®°ä»“åº“æœ‰å­ç›®å½•ï¼ˆå¦‚notes/ï¼‰ï¼Œéœ€å¤åˆ¶å†…å®¹
      - name: Copy notes content
        if: steps.checkout-notes.outputs.tree != 'empty'
        run: |
          # å‡è®¾ç¬”è®°ä»“åº“çš„Markdownåœ¨notes/ç›®å½•ä¸‹
          mkdir -p temp-notes
          cp -r NOTE_REPO_PATH/notes/* temp-notes/  # æ›¿æ¢ä¸ºå®é™…è·¯å¾„

      # 4. ç”Ÿæˆé™æ€é¡µé¢
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18

      - name: Install dependencies
        run: npm install

      - name: Build static site
        run: npm run build

      # 5. éƒ¨ç½²åˆ°GitHub Pages
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./public
          publish_branch: gh-pages
```

> ğŸ’¡ **å…³é”®æ›¿æ¢é¡¹**ï¼ˆåœ¨ `deploy.yml` ä¸­ï¼‰ï¼š
>
> - `YOUR_NOTE_REPO_OWNER/NOTE_REPO_NAME` â†’ æ›¿æ¢ä¸ºä½ çš„ç¬”è®°ä»“åº“åœ°å€ï¼ˆå¦‚ `octocat/notes`ï¼‰
> - `NOTE_REPO_PATH/notes/*` â†’ å¦‚æœç¬”è®°ä»“åº“çš„ Markdown æ–‡ä»¶åœ¨ `notes/` ç›®å½•ä¸‹ï¼Œä¿æŒæ­¤è·¯å¾„ï¼›å¦‚æœç›´æ¥åœ¨æ ¹ç›®å½•ï¼Œæ”¹ä¸º `NOTE_REPO_PATH/*`

---

### ğŸš€ éƒ¨ç½²æµç¨‹

1. **æäº¤åšå®¢ä»“åº“ä»£ç **

   ```bash
   git add .
   git commit -m "Setup cross-repo blog"
   git push origin main
   ```

2. **å¯ç”¨ GitHub Pages**

   - è¿›å…¥åšå®¢ä»“åº“ â†’ Settings â†’ Pages
   - Source é€‰æ‹© `gh-pages branch`
   - ä¿å­˜åç­‰å¾… 1-2 åˆ†é’Ÿ

3. **è®¿é—®ä½ çš„åšå®¢**

   - URLï¼š`https://<ä½ çš„GitHubç”¨æˆ·å>.github.io/<åšå®¢ä»“åº“å>`
   - ç¤ºä¾‹ï¼š`https://username.github.io/blog`

4. **æµ‹è¯•è‡ªåŠ¨åŒæ­¥**
   - å»ç¬”è®°ä»“åº“æ–°å¢/ä¿®æ”¹ Markdown æ–‡ä»¶
   - ç­‰å¾… 1 å°æ—¶ï¼ˆæˆ–æ‰‹åŠ¨è§¦å‘å·¥ä½œæµï¼‰
   - åšå®¢ä¼šè‡ªåŠ¨æ›´æ–°ï¼

---

### ğŸ” å¸¸è§é—®é¢˜è§£å†³

#### â“ ä¸ºä»€ä¹ˆéœ€è¦ `NOTE_REPO_PATH/notes/*`ï¼Ÿ

- å¦‚æœä½ çš„ç¬”è®°ä»“åº“ç»“æ„æ˜¯ï¼š
  ```
  notes-repo/
    â”œâ”€â”€ notes/       # æ‰€æœ‰Markdownæ–‡ä»¶åœ¨æ­¤
    â”‚   â”œâ”€â”€ post1.md
    â”‚   â””â”€â”€ images/
    â””â”€â”€ README.md    # ä¸éœ€è¦çš„æ–‡ä»¶
  ```
- åˆ™éœ€è¦å¤åˆ¶ `notes/` ç›®å½•å†…å®¹åˆ° `temp-notes`ï¼š
  ```yaml
  - name: Copy notes content
    run: |
      mkdir -p temp-notes
      cp -r temp-notes/notes/* temp-notes/  # æ³¨æ„ï¼šè¿™é‡Œä¼šè¦†ç›–temp-notes
  ```

#### â“ å¦‚ä½•å¤„ç†å›¾ç‰‡è·¯å¾„ï¼Ÿ

- âœ… **å®Œå…¨è‡ªåŠ¨å¤„ç†**ï¼šåœ¨ Markdown ä¸­å†™ `![å›¾ç‰‡](images/photo.jpg)`ï¼Œå›¾ç‰‡ä¼šè‡ªåŠ¨å¤åˆ¶åˆ° `public/images/`
- âœ… è®¿é—®æ—¶ç›´æ¥ä½¿ç”¨ `/images/photo.jpg` è·¯å¾„

#### â“ ç¬”è®°ä»“åº“æ˜¯ç§æœ‰çš„æ€ä¹ˆåŠï¼Ÿ

- åœ¨åˆ›å»º PAT æ—¶å‹¾é€‰ `repo` å…¨æƒé™ï¼ˆå› ä¸ºç§æœ‰ä»“åº“éœ€è¦å®Œæ•´æƒé™ï¼‰
- ç¡®ä¿ PAT æœ‰ `repo` æƒé™ï¼ˆé `public_repo`ï¼‰

#### â“ å¦‚ä½•åŠ é€ŸåŒæ­¥ï¼ˆéæ¯å°æ—¶ï¼‰ï¼Ÿ

- ä¿®æ”¹ `deploy.yml` ä¸­çš„ `cron` è¡¨è¾¾å¼ï¼š
  ```yaml
  schedule:
    - cron: "*/30 * * * *" # æ¯30åˆ†é’ŸåŒæ­¥ä¸€æ¬¡
  ```
- æˆ–æ‰‹åŠ¨è§¦å‘ï¼šè¿›å…¥åšå®¢ä»“åº“ â†’ Actions â†’ å³ä¾§ "Sync Notes & Deploy" â†’ ç‚¹å‡» "Run workflow"

---

### ğŸ’¡ ä¸ºä»€ä¹ˆè¿™ä¸ªæ–¹æ¡ˆæœ€å®‰å…¨ï¼Ÿ

| å®‰å…¨ç‰¹æ€§           | è¯´æ˜                                                     |
| ------------------ | -------------------------------------------------------- |
| **æœ€å°æƒé™åŸåˆ™**   | PAT ä»…éœ€ `repo:status` å’Œ `repo:public_repo`ï¼ˆåªè¯»æƒé™ï¼‰ |
| **æ— æ•æ„Ÿä¿¡æ¯æ³„éœ²** | PAT ä»…å­˜äº GitHub Secretsï¼Œä»£ç ä¸­æ°¸ä¸å‡ºç°                |
| **éš”ç¦»éƒ¨ç½²**       | åšå®¢ä»“åº“å’Œç¬”è®°ä»“åº“å®Œå…¨éš”ç¦»ï¼Œä¸€ä¸ªä»“åº“è¢«é»‘ä¸å½±å“å¦ä¸€ä¸ª     |
| **æ— åç«¯ä¾èµ–**     | æ‰€æœ‰æ“ä½œåœ¨ GitHub å†…éƒ¨å®Œæˆï¼Œæ— éœ€æš´éœ²æœåŠ¡å™¨ IP æˆ– API     |

---

### âœ… æœ€ç»ˆæ•ˆæœ

- âœ¨ **ç¬”è®°ä»“åº“**ï¼šä¸“æ³¨å†™å†…å®¹ï¼ˆMarkdown + å›¾ç‰‡ï¼‰
- âœ¨ **åšå®¢ä»“åº“**ï¼šåªè´Ÿè´£ç”Ÿæˆé™æ€é¡µï¼ˆæ— ä»»ä½•å†…å®¹ï¼‰
- âœ¨ **è‡ªåŠ¨åŒæ­¥**ï¼šæ¯å°æ—¶è‡ªåŠ¨æ‹‰å–æœ€æ–°ç¬”è®°å†…å®¹
- âœ¨ **é›¶ç»´æŠ¤**ï¼šå®Œå…¨è‡ªåŠ¨åŒ–ï¼Œæ— éœ€ä»»ä½•æœåŠ¡å™¨

> âš¡ï¸ **ç«‹å³åŠ¨æ‰‹è¯•è¯•**ï¼š
>
> 1. å¤åˆ¶ä¸Šé¢çš„ä»£ç æ¨¡æ¿åˆ°ä½ çš„åšå®¢ä»“åº“
> 2. æ›¿æ¢ `deploy.yml` ä¸­çš„ç¬”è®°ä»“åº“åœ°å€
> 3. æäº¤ä»£ç  â†’ ç­‰å¾… 1 å°æ—¶ â†’ è®¿é—®ä½ çš„åšå®¢ï¼
>
> **æ— éœ€ä»»ä½•åç«¯çŸ¥è¯†ï¼Œçº¯å‰ç«¯æ–¹æ¡ˆï¼Œ100% å…è´¹ï¼** ğŸš€
